<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/core-ajax/core-ajax.html">

<polymer-element name="nautes-dashboard-service" attributes="boxesObjects">
  <template>
    <style>
    :host {
      display: none;
    }
    </style>
    <core-ajax id="ajax"
      auto
      url="../api/boxes.json"
      on-core-response="{{boxesLoaded}}"
      handleAs="json">
    </core-ajax>
  </template>
  <script>
    Polymer("nautes-dashboard-service",{
      created: function() {
        this.boxesObjects = {};
      },
      boxesLoaded: function() {
        // Make a copy of the loaded data
        var boxes = this.$.ajax.response.slice(0);
        for (var i = boxes.length - 1; i >= 0; i--) {
          var box = boxes[i];
          this.boxesObjects[box.title.toLowerCase()] = box;
        }
      }
    });
  </script>
</polymer-element>
