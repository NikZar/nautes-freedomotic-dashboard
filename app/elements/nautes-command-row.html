<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/core-icon/core-icon.html">
<link rel="import" href="../bower_components/core-icons/core-icons.html">
<link rel="import" href="../bower_components/core-icons/image-icons.html">
<link rel="import" href="../bower_components/core-icons/hardware-icons.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/fd-polymer-rest-service/fd-polymer-rest-service.html">

<link rel="import" href="../elements/fd-tag-manager.html">
<link rel="import" href="../elements/fd-property-manager.html">
<link rel="import" href="../elements/fd-manageable-element.html">

<polymer-element name="nautes-command-row" attributes="toast command bgColor">
<template>
  <style>

    :host {
      display: block;
      position: relative;
      background-color: {{bgColor}};
      width: 100%;
      font-size: 1.2rem;
      font-weight: 300;
      font-family: Open Sans;
    }

    .command-row {
      margin-bottom: 10px;
      padding: 20px;
      color: #444;
      min-height: 70px;
    }

    .command-input {
      margin-bottom: 5px;
      padding: 5px;
      color: #444;
      min-height: 60px;
    }
    .command-form {
      background-color: #eee;
    }

    .icon{

      width: 70px;
      height: 70px;
    }

    paper-ripple {
        z-index: 1;
        color: #aaaaff;
    }
  </style>

  <fd-manageable-element elmnt="{{command}}" apiBase="commands/user" bgColor="{{bgColor}}">
  <h2>{{command.name}}</h2>
  <description>{{command.receiver}}</description>
  <element-icon>
    <core-icon class="icon" icon="hardware:gamepad" on-tap="{{run}}"></core-icon>
    </element-icon>
  <header>
    <fd-rest-service id="runService" 
      auto="false"
      method="POST" 
      fdtype="commands/user/{{command.uuid}}/run"  
      on-rest-response="{{successHandler}}"
      toast="{{toast}}">
    </fd-rest-service>
</header>
<!-- inserire qua il form per modificare il comando -->
<form>
  <div class="command-input" layout horizonal right start>
    <div>Name:</div>
    <paper-input id="nameInput"
    label="{{command.name}}" 
    inputValue="{{command.name}}">
  </paper-input>
</div>
<div class="command-input" layout horizonal right>
  <div>Description:</div>
  <paper-input id="descriptionInput"
  label="{{command.description}}" 
  inputValue="{{command.description}}">
</paper-input>
</div>
<div class="command-input" layout horizonal right>
  <div>Channel:</div>
  <paper-input id="channelInput"
  label="{{command.receiver}}" 
  inputValue="{{command.receiver}}">
</paper-input>
</div>
<div class="command-input" layout horizonal right>
  <div>Delay:</div>
  <paper-input id="delayInput"
  label="{{command.delay}}" 
  inputValue="{{command.delay}}">
</paper-input>
</div>
<div class="command-input" layout horizonal right>
  <div>Reply timeout:</div>
  <paper-input id="replyTimeoutInput"
  label="{{command.replyTimeout}}" 
  inputValue="{{command.replyTimeout}}">
</paper-input>
</div>
<div class="command-input" layout horizonal right>
  <fd-tag-manager tags="{{command.tags}}">
  <header>Tags: </header>
</fd-tag-manager>
</div>
<div class="command-input" layout horizonal right>
  <fd-property-manager properties="{{command.properties.properties}}">
  </fd-property-manager>
</div>
</form>
<!-- end --> 
</fd-manageable-element>
</template>
  <script>
    Polymer("nautes-command-row",{

      run: function(){
        console.log("Running command" + this.command.uuid);
        this.$.runService.go();
      },

      successHandler: function(event){
        if(this.toast){
          this.toast.text= this.command.name + " run with success! ";
          this.toast.show();
        }
      }
    });
  </script>
</polymer-element>
