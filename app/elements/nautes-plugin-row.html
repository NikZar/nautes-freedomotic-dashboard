<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/core-icon/core-icon.html">
<link rel="import" href="../bower_components/core-icons/core-icons.html">
<link rel="import" href="../bower_components/core-icons/image-icons.html">
<link rel="import" href="../bower_components/core-icons/hardware-icons.html">
<link rel="import" href="../bower_components/fd-polymer-rest-service/fd-polymer-rest-service.html">

<link rel="import" href="../elements/fd-manageable-element.html">
<link rel="import" href="../elements/fd-image.html">

<polymer-element name="nautes-plugin-row" attributes="plugin bgColor">
  <template>
    <style>

      :host {
        display: block;
        position: relative;
        background-color: {{bgColor}};
        width: 100%;
        font-size: 1.2rem;
        font-weight: 300;
        font-family: Open Sans;
      }

      .icon{
        width: 70px;
        height: 70px;
        border-radius: 10%;
      }

    </style>
<fd-manageable-element element="{{plugin}}" apiBase="plugins" bgColor="{{bgColor}}">
    
    <fd-rest-service id="startPluginService" 
      auto="false"
      method="POST" 
      fdtype="plugins/{{plugin.uuid}}/start"  
      on-rest-response="{{started}}"
      toast="{{toast}}">
    </fd-rest-service>

    <fd-rest-service id="stopPluginService" 
      auto="false"
      method="POST" 
      fdtype="plugins/{{plugin.uuid}}/stop"  
      on-rest-response="{{stopped}}"
      toast="{{toast}}">
    </fd-rest-service>

<element-icon>
    <fd-image class="icon" 
        primary="{{plugin.uuid}}-{{plugin.currentPluginStatus}}.png" alternate="plugin-{{plugin.currentPluginStatus}}.png" 
        on-tap="{{startPlugin}"/>
        <paper-ripple class="circle" fit></paper-ripple>
</element-icon>
<h2>{{plugin.pluginName}}</h2>
<description>{{plugin.description}}</description>
<header></header>
<form></form>
</fd-manageable-element>      
  </template>
  <script>
    Polymer("nautes-plugin-row",{

      startPlugin: function(){
        this.$.startPluginService.go();
      },

      stopPlugin: function(){
        this.$.stopPluginService.go();
      },

      started: function(event){
        if(this.toast){
          this.toast.text= this.command.name + " started with success! ";
          this.toast.show();
        }
        this.fire("start");
      },

      stopped: function(event){
        if(this.toast){
          this.toast.text= this.command.name + " stopped with success! ";
          this.toast.show();
        }
        this.fire("stop");
      }

    });
  </script>
</polymer-element>

